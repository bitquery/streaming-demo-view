<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="icon" href="https://graphql.bitquery.io/ide/favicon.png" />
	<title>Bitquery Streaming API</title>
  <script type="module" crossorigin>
(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))S(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const g of a.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&S(g)}).observe(document,{childList:!0,subtree:!0});function m(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function S(i){if(i.ep)return;i.ep=!0;const a=m(i);fetch(i.href,a)}})();function w(e){return e===null?"null":Array.isArray(e)?"array":typeof e}function B(e){return w(e)==="object"}function ee(e){return Array.isArray(e)&&e.length>0&&e.every(c=>"message"in c)}function X(e,c){return e.length<124?e:c}const te="graphql-transport-ws";var x;(function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"})(x||(x={}));var l;(function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"})(l||(l={}));function G(e){if(!B(e))throw new Error(`Message is expected to be an object, but got ${w(e)}`);if(!e.type)throw new Error("Message is missing the 'type' property");if(typeof e.type!="string")throw new Error(`Message is expects the 'type' property to be a string, but got ${w(e.type)}`);switch(e.type){case l.ConnectionInit:case l.ConnectionAck:case l.Ping:case l.Pong:{if("payload"in e&&!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object or missing, but got "${e.payload}"`);break}case l.Subscribe:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${w(e.payload)}`);if(typeof e.payload.query!="string")throw new Error(`"${e.type}" message payload expects the 'query' property to be a string, but got ${w(e.payload.query)}`);if(e.payload.variables!=null&&!B(e.payload.variables))throw new Error(`"${e.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${w(e.payload.variables)}`);if(e.payload.operationName!=null&&w(e.payload.operationName)!=="string")throw new Error(`"${e.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${w(e.payload.operationName)}`);if(e.payload.extensions!=null&&!B(e.payload.extensions))throw new Error(`"${e.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${w(e.payload.extensions)}`);break}case l.Next:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${w(e.payload)}`);break}case l.Error:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!ee(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(e.payload)}`);break}case l.Complete:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);break}default:throw new Error(`Invalid message 'type' property "${e.type}"`)}return e}function re(e,c){try{return G(e)}catch{if(typeof e!="string")throw new Error("Only strings are parsable messages");const S=JSON.parse(e,c);return G(S)}}function H(e,c){return G(e),JSON.stringify(e,c)}function ne(e){const{url:c,connectionParams:m,lazy:S=!0,onNonLazyError:i=console.error,lazyCloseTimeout:a=0,keepAlive:g=0,disablePong:u,connectionAckWaitTimeout:$=0,retryAttempts:P=5,retryWait:h=async function(p){let s=1e3;for(let n=0;n<p;n++)s*=2;await new Promise(n=>setTimeout(n,s+Math.floor(Math.random()*(3e3-300)+300)))},shouldRetry:k=j,isFatalConnectionProblem:E,on:t,webSocketImpl:T,generateID:L=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,p=>{const s=Math.random()*16|0;return(p=="x"?s:s&3|8).toString(16)})},jsonMessageReplacer:N,jsonMessageReviver:O}=e;let C;if(T){if(!ie(T))throw new Error("Invalid WebSocket implementation provided");C=T}else typeof WebSocket<"u"?C=WebSocket:typeof global<"u"?C=global.WebSocket||global.MozWebSocket:typeof window<"u"&&(C=window.WebSocket||window.MozWebSocket);if(!C)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const _=C,b=(()=>{const r=(()=>{const s={};return{on(n,d){return s[n]=d,()=>{delete s[n]}},emit(n){var d;"id"in n&&((d=s[n.id])===null||d===void 0||d.call(s,n))}}})(),p={connecting:t!=null&&t.connecting?[t.connecting]:[],opened:t!=null&&t.opened?[t.opened]:[],connected:t!=null&&t.connected?[t.connected]:[],ping:t!=null&&t.ping?[t.ping]:[],pong:t!=null&&t.pong?[t.pong]:[],message:t!=null&&t.message?[r.emit,t.message]:[r.emit],closed:t!=null&&t.closed?[t.closed]:[],error:t!=null&&t.error?[t.error]:[]};return{onMessage:r.on,on(s,n){const d=p[s];return d.push(n),()=>{d.splice(d.indexOf(n),1)}},emit(s,...n){for(const d of[...p[s]])d(...n)}}})();function V(r){const p=[b.on("error",s=>{p.forEach(n=>n()),r(s)}),b.on("closed",s=>{p.forEach(n=>n()),r(s)})]}let A,I=0,J,z=!1,W=0,Q=!1;async function U(){clearTimeout(J);const[r,p]=await(A!=null?A:A=new Promise((d,M)=>(async()=>{if(z){if(await h(W),!I)return A=void 0,M({code:1e3,reason:"All Subscriptions Gone"});W++}b.emit("connecting");const o=new _(typeof c=="function"?await c():c,te);let q,D;function F(){isFinite(g)&&g>0&&(clearTimeout(D),D=setTimeout(()=>{o.readyState===_.OPEN&&(o.send(H({type:l.Ping})),b.emit("ping",!1,void 0))},g))}V(y=>{A=void 0,clearTimeout(q),clearTimeout(D),M(y),j(y)&&y.code===4499&&(o.close(4499,"Terminated"),o.onerror=null,o.onclose=null)}),o.onerror=y=>b.emit("error",y),o.onclose=y=>b.emit("closed",y),o.onopen=async()=>{try{b.emit("opened",o);const y=typeof m=="function"?await m():m;if(o.readyState!==_.OPEN)return;o.send(H(y?{type:l.ConnectionInit,payload:y}:{type:l.ConnectionInit},N)),isFinite($)&&$>0&&(q=setTimeout(()=>{o.close(x.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")},$)),F()}catch(y){b.emit("error",y),o.close(x.InternalClientError,X(y instanceof Error?y.message:new Error(y).message,"Internal client error"))}};let R=!1;o.onmessage=({data:y})=>{try{const f=re(y,O);if(b.emit("message",f),f.type==="ping"||f.type==="pong"){b.emit(f.type,!0,f.payload),f.type==="pong"?F():u||(o.send(H(f.payload?{type:l.Pong,payload:f.payload}:{type:l.Pong})),b.emit("pong",!1,f.payload));return}if(R)return;if(f.type!==l.ConnectionAck)throw new Error(`First message cannot be of type ${f.type}`);clearTimeout(q),R=!0,b.emit("connected",o,f.payload),z=!1,W=0,d([o,new Promise((ce,v)=>V(v))])}catch(f){o.onmessage=null,b.emit("error",f),o.close(x.BadResponse,X(f instanceof Error?f.message:new Error(f).message,"Bad response"))}}})()));r.readyState===_.CLOSING&&await p;let s=()=>{};const n=new Promise(d=>s=d);return[r,s,Promise.race([n.then(()=>{if(!I){const d=()=>r.close(1e3,"Normal Closure");isFinite(a)&&a>0?J=setTimeout(()=>{r.readyState===_.OPEN&&d()},a):d()}}),p])]}function Z(r){if(j(r)&&(oe(r.code)||[x.InternalServerError,x.InternalClientError,x.BadRequest,x.BadResponse,x.Unauthorized,x.SubprotocolNotAcceptable,x.SubscriberAlreadyExists,x.TooManyInitialisationRequests].includes(r.code)))throw r;if(Q)return!1;if(j(r)&&r.code===1e3)return I>0;if(!P||W>=P||!k(r)||E!=null&&E(r))throw r;return z=!0}return S||(async()=>{for(I++;;)try{const[,,r]=await U();await r}catch(r){try{if(!Z(r))return}catch(p){return i==null?void 0:i(p)}}})(),{on:b.on,subscribe(r,p){const s=L();let n=!1,d=!1,M=()=>{I--,n=!0};return(async()=>{for(I++;;)try{const[o,q,D]=await U();if(n)return q();const F=b.onMessage(s,R=>{switch(R.type){case l.Next:{p.next(R.payload);return}case l.Error:{d=!0,n=!0,p.error(R.payload),M();return}case l.Complete:{n=!0,M();return}}});o.send(H({id:s,type:l.Subscribe,payload:r},N)),M=()=>{!n&&o.readyState===_.OPEN&&o.send(H({id:s,type:l.Complete},N)),I--,n=!0,q()},await D.finally(F);return}catch(o){if(!Z(o))return}})().then(()=>{d||p.complete()}).catch(o=>{p.error(o)}),()=>{n||M()}},async dispose(){if(Q=!0,A){const[r]=await A;r.close(1e3,"Normal Closure")}},terminate(){A&&b.emit("closed",{code:4499,reason:"Terminated",wasClean:!1})}}}function j(e){return B(e)&&"code"in e&&"reason"in e}function oe(e){return[1e3,1001,1006,1005,1012,1013,1013].includes(e)?!1:e>=1e3&&e<=1999}function ie(e){return typeof e=="function"&&"constructor"in e&&"CLOSED"in e&&"CLOSING"in e&&"CONNECTING"in e&&"OPEN"in e}setInterval(()=>document.getElementById("datetime").innerHTML=new Date().toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}),1);const Y=ne({url:"wss://streaming.bitquery.io/graphql"}),K=(e,c)=>{const m=document.createElement("div");m.classList.add("nft"),m.style.backgroundImage=`url(${e})`;const S=Math.random()*window.innerWidth;m.style.left=`${S}px`;const i=document.getElementById("app"),a=document.createElement("span");a.innerHTML=c||"",m.appendChild(a),i.appendChild(m),setTimeout(()=>{i.removeChild(m)},5e3)};async function se(e){return new Promise((c,m)=>{let S;Y.subscribe(e,{next:async i=>{i.data.EVM.Transfers.forEach(async({Transfer:{URI:g,name:u}})=>{if(g&&g.match(/data:image/gm))K(g,u);else if(!g.match(/^ipfs:\/\//gm))try{const P=await(await fetch(g)).json();P.image&&K(P.image,P.name)}catch{}})},error:m,complete:()=>c(S)})})}async function ae(e){return new Promise((c,m)=>{let S;Y.subscribe(e,{next:i=>{const a=i.data.EVM,g=document.getElementById("trades");a.buy.forEach((u,$,P)=>{const h=document.createElement("div"),k=document.createElement("div"),E=document.createElement("div"),t=document.createElement("div"),T=document.createElement("div");h.classList.add("trades__row"),k.classList.add("trades__column","time"),E.classList.add("trades__column","address"),t.classList.add("trades__column","action"),T.classList.add("trades__column","forprice"),k.innerHTML=`${new Date(u.Block.Time).toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}).split(", ")[1]}`,E.innerHTML=` ${u.Trade.Sell.Buyer.substring(0,10)}...`,t.innerHTML=` buy ${u.Trade.Buy.Amount.Decimal.substring(0,10)} ${u.Trade.Buy.Currency.Symbol}`,T.innerHTML=` for ${u.Trade.Sell.Amount.Decimal.substring(0,6)} ${u.Trade.Sell.Currency.Symbol}`,setTimeout(()=>{h.appendChild(k),h.appendChild(E),h.appendChild(t),h.appendChild(T),g.appendChild(h);const L=document.getElementById("price"),N=u.Trade.Buy.Price,O=+N>+L.innerHTML?"green":"red";L.innerHTML=N.toFixed(5),L.classList.remove("green","red"),L.classList.add(O)},$*2500/a.buy.length)}),a.sell.forEach((u,$,P)=>{const h=document.createElement("div"),k=document.createElement("div"),E=document.createElement("div"),t=document.createElement("div"),T=document.createElement("div");h.classList.add("trades__row"),k.classList.add("trades__column","time"),E.classList.add("trades__column","address"),t.classList.add("trades__column","action"),T.classList.add("trades__column","forprice"),k.innerHTML=`${new Date(u.Block.Time).toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}).split(", ")[1]}`,E.innerHTML=` ${u.Trade.Sell.Buyer.substring(0,10)}...`,t.innerHTML=` sell ${u.Trade.Sell.Amount.Decimal.substring(0,10)} ${u.Trade.Sell.Currency.Symbol}`,T.innerHTML=` for ${u.Trade.Buy.Amount.Decimal.substring(0,6)} ${u.Trade.Buy.Currency.Symbol}`,setTimeout(()=>{h.appendChild(k),h.appendChild(E),h.appendChild(t),h.appendChild(T),g.appendChild(h);const L=document.getElementById("price"),N=u.Trade.Sell.Price,O=+N>+L.innerHTML?"green":"red";L.innerHTML=N.toFixed(5),L.classList.remove("green","red"),L.classList.add(O)},$*2500/a.sell.length)})},error:m,complete:()=>c(S)})})}(async()=>{try{const e=await Promise.all[ae({query:`subscription {
				EVM(network: bsc){
				  buy: DEXTrades(Trade: {
					Sell: {Currency: {SmartContract: {is: "0x55d398326f99059ff775485246999027b3197955"}}}
					Buy: {Currency: {SmartContract: {is: "0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"}}}
				  }) {
					Block {
					  Time
					}
					Trade {
					  Sell {
						Buyer
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
								  }
					  }
					  Buy {
						Price
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
						}
					  }
					}
				  }
				  sell: DEXTrades(Trade: {
					Buy: {Currency: {SmartContract: {is: "0x55d398326f99059ff775485246999027b3197955"}}}
					Sell: {Currency: {SmartContract: {is: "0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"}}}
			  
				  }) {
					Block {
					  Time
					}
					Trade {
					  Sell {
						Price
						Buyer
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
								  }
					  }
					  Buy {
						
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
						}
					  }
					}
				  }
				}
			  }`}),se({query:`subscription {
			 EVM(network: bsc){
			  	Transfers(Transfer: {Currency: {HasURI: true}}) {
			     Transfer {
			       Receiver
			       Currency {
			         Name
			       }
			       URI
			      }
			    }
			  }
			}`})]}catch(e){console.log(e)}})();

</script>
  <style type="text/css">
@charset "UTF-8";*,*:before,*:after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media (prefers-reduced-motion: reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}.red{color:red}.green{color:green}@keyframes falling{0%{top:0;opacity:1}to{top:100%;opacity:0}}#app{font-family:swiss921-bt-regular,sans-serif;background-color:#000;color:#ececec;font-size:1.5vmax;display:flex;width:100vw;height:100vh;position:relative}#app .nft{height:10vmax;width:10vmax;z-index:15;position:absolute;background-size:cover;top:0;animation:falling 10s;animation-iteration-count:1}#app .logo{position:absolute;z-index:20;top:50px;right:7vmax;height:50px}#app .container{display:flex;flex-direction:column;flex:1 1 33%;height:100%}#app .container__left{position:relative}#app .container__left .item{display:flex;padding-left:7vmax}#app .container__left .item.number{padding-top:50px;flex:0 1 20%}#app .container__left .item.plug{position:relative;flex-direction:column;flex:0 1 80%;justify-content:flex-end}#app .container__left .item.cover{position:absolute;height:80vh;width:100vw;top:0;background-image:linear-gradient(to top,rgba(0,0,0,0) 0%,rgba(0,0,0,.9) 50%,rgb(0,0,0) 100%);z-index:10}#app .container__left .item.trades{position:absolute;display:flex;flex-direction:column;justify-content:flex-end;bottom:0;height:80vh;width:100vw;font-size:26px;opacity:.8;padding-left:3vmax}#app .container__left .item.trades .trades__row{display:flex;width:100%;height:3vmax;font-size:1.9vmax}#app .container__left .item.trades .trades__column{display:flex;flex:1;justify-content:flex-start}#app .container__left .item.trades .trades__column.time{flex-basis:15%}#app .container__left .item.trades .trades__column.address{flex-basis:25%}#app .container__left .item.trades .trades__column.action{flex-basis:35%}#app .container__left .item.trades .trades__column.forprice{flex-basis:25%}#app .container__middle{z-index:20;justify-content:center;align-items:center}#app .container__middle .token-price-exchange{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;margin:auto}#app .container__middle .token-price-exchange .token{font-size:4vmax}#app .container__middle .token-price-exchange .price{font-size:10vmax;font-weight:700}#app .container__middle .token-price-exchange .exchange{font-weight:700;margin-top:-2vmax}#app .container__middle .datetime{font-size:3vmax}#app .container__right{position:relative;justify-content:flex-end;align-items:center}

</style>
</head>
<body>
	<div id="app">
		<image class="logo" src="https://bitquery.io/wp-content/uploads/2021/11/Bitquery-RGB-White-Title-1024x328.png">
		</image>
		<div class="container container__left">
			<div class="item number"></div>
			<div class="item plug"></div>
			<div class="item cover"></div>
			<div id="trades" class="item trades">
			</div>
		</div>
		<div class="container container__middle">
			<div id="datetime" class="datetime"></div>
			<div class="token-price-exchange">
				<div id="price" class="price">--/--</div>
				<div class="token">WBNB/USDT</div>
				<div class="exchange"></div>
			</div>
		</div>
		<div class="container container__right">
		</div>
		<div class="nft"></div>
	</div>
	
</body>

</html>