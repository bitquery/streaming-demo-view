<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="icon" href="https://graphql.bitquery.io/ide/favicon.png" />
	<title>Bitquery Streaming API</title>
  <script type="module" crossorigin>
(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))T(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&T(i)}).observe(document,{childList:!0,subtree:!0});function m(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function T(s){if(s.ep)return;s.ep=!0;const c=m(s);fetch(s.href,c)}})();function w(e){return e===null?"null":Array.isArray(e)?"array":typeof e}function B(e){return w(e)==="object"}function ee(e){return Array.isArray(e)&&e.length>0&&e.every(d=>"message"in d)}function X(e,d){return e.length<124?e:d}const te="graphql-transport-ws";var S;(function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"})(S||(S={}));var p;(function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"})(p||(p={}));function G(e){if(!B(e))throw new Error(`Message is expected to be an object, but got ${w(e)}`);if(!e.type)throw new Error("Message is missing the 'type' property");if(typeof e.type!="string")throw new Error(`Message is expects the 'type' property to be a string, but got ${w(e.type)}`);switch(e.type){case p.ConnectionInit:case p.ConnectionAck:case p.Ping:case p.Pong:{if("payload"in e&&!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object or missing, but got "${e.payload}"`);break}case p.Subscribe:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${w(e.payload)}`);if(typeof e.payload.query!="string")throw new Error(`"${e.type}" message payload expects the 'query' property to be a string, but got ${w(e.payload.query)}`);if(e.payload.variables!=null&&!B(e.payload.variables))throw new Error(`"${e.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${w(e.payload.variables)}`);if(e.payload.operationName!=null&&w(e.payload.operationName)!=="string")throw new Error(`"${e.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${w(e.payload.operationName)}`);if(e.payload.extensions!=null&&!B(e.payload.extensions))throw new Error(`"${e.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${w(e.payload.extensions)}`);break}case p.Next:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${w(e.payload)}`);break}case p.Error:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!ee(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(e.payload)}`);break}case p.Complete:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${w(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);break}default:throw new Error(`Invalid message 'type' property "${e.type}"`)}return e}function re(e,d){try{return G(e)}catch{if(typeof e!="string")throw new Error("Only strings are parsable messages");const T=JSON.parse(e,d);return G(T)}}function H(e,d){return G(e),JSON.stringify(e,d)}function ne(e){const{url:d,connectionParams:m,lazy:T=!0,onNonLazyError:s=console.error,lazyCloseTimeout:c=0,keepAlive:i=0,disablePong:l,connectionAckWaitTimeout:E=0,retryAttempts:N=5,retryWait:f=async function(y){let a=1e3;for(let n=0;n<y;n++)a*=2;await new Promise(n=>setTimeout(n,a+Math.floor(Math.random()*(3e3-300)+300)))},shouldRetry:x=j,isFatalConnectionProblem:$,on:t,webSocketImpl:L,generateID:k=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,y=>{const a=Math.random()*16|0;return(y=="x"?a:a&3|8).toString(16)})},jsonMessageReplacer:A,jsonMessageReviver:q}=e;let C;if(L){if(!ie(L))throw new Error("Invalid WebSocket implementation provided");C=L}else typeof WebSocket<"u"?C=WebSocket:typeof global<"u"?C=global.WebSocket||global.MozWebSocket:typeof window<"u"&&(C=window.WebSocket||window.MozWebSocket);if(!C)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const _=C,h=(()=>{const r=(()=>{const a={};return{on(n,u){return a[n]=u,()=>{delete a[n]}},emit(n){var u;"id"in n&&((u=a[n.id])===null||u===void 0||u.call(a,n))}}})(),y={connecting:t!=null&&t.connecting?[t.connecting]:[],opened:t!=null&&t.opened?[t.opened]:[],connected:t!=null&&t.connected?[t.connected]:[],ping:t!=null&&t.ping?[t.ping]:[],pong:t!=null&&t.pong?[t.pong]:[],message:t!=null&&t.message?[r.emit,t.message]:[r.emit],closed:t!=null&&t.closed?[t.closed]:[],error:t!=null&&t.error?[t.error]:[]};return{onMessage:r.on,on(a,n){const u=y[a];return u.push(n),()=>{u.splice(u.indexOf(n),1)}},emit(a,...n){for(const u of[...y[a]])u(...n)}}})();function U(r){const y=[h.on("error",a=>{y.forEach(n=>n()),r(a)}),h.on("closed",a=>{y.forEach(n=>n()),r(a)})]}let M,P=0,V,F=!1,W=0,J=!1;async function Q(){clearTimeout(V);const[r,y]=await(M!=null?M:M=new Promise((u,I)=>(async()=>{if(F){if(await f(W),!P)return M=void 0,I({code:1e3,reason:"All Subscriptions Gone"});W++}h.emit("connecting");const o=new _(typeof d=="function"?await d():d,te);let R,D;function z(){isFinite(i)&&i>0&&(clearTimeout(D),D=setTimeout(()=>{o.readyState===_.OPEN&&(o.send(H({type:p.Ping})),h.emit("ping",!1,void 0))},i))}U(g=>{M=void 0,clearTimeout(R),clearTimeout(D),I(g),j(g)&&g.code===4499&&(o.close(4499,"Terminated"),o.onerror=null,o.onclose=null)}),o.onerror=g=>h.emit("error",g),o.onclose=g=>h.emit("closed",g),o.onopen=async()=>{try{h.emit("opened",o);const g=typeof m=="function"?await m():m;if(o.readyState!==_.OPEN)return;o.send(H(g?{type:p.ConnectionInit,payload:g}:{type:p.ConnectionInit},A)),isFinite(E)&&E>0&&(R=setTimeout(()=>{o.close(S.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")},E)),z()}catch(g){h.emit("error",g),o.close(S.InternalClientError,X(g instanceof Error?g.message:new Error(g).message,"Internal client error"))}};let O=!1;o.onmessage=({data:g})=>{try{const b=re(g,q);if(h.emit("message",b),b.type==="ping"||b.type==="pong"){h.emit(b.type,!0,b.payload),b.type==="pong"?z():l||(o.send(H(b.payload?{type:p.Pong,payload:b.payload}:{type:p.Pong})),h.emit("pong",!1,b.payload));return}if(O)return;if(b.type!==p.ConnectionAck)throw new Error(`First message cannot be of type ${b.type}`);clearTimeout(R),O=!0,h.emit("connected",o,b.payload),F=!1,W=0,u([o,new Promise((le,v)=>U(v))])}catch(b){o.onmessage=null,h.emit("error",b),o.close(S.BadResponse,X(b instanceof Error?b.message:new Error(b).message,"Bad response"))}}})()));r.readyState===_.CLOSING&&await y;let a=()=>{};const n=new Promise(u=>a=u);return[r,a,Promise.race([n.then(()=>{if(!P){const u=()=>r.close(1e3,"Normal Closure");isFinite(c)&&c>0?V=setTimeout(()=>{r.readyState===_.OPEN&&u()},c):u()}}),y])]}function Z(r){if(j(r)&&(oe(r.code)||[S.InternalServerError,S.InternalClientError,S.BadRequest,S.BadResponse,S.Unauthorized,S.SubprotocolNotAcceptable,S.SubscriberAlreadyExists,S.TooManyInitialisationRequests].includes(r.code)))throw r;if(J)return!1;if(j(r)&&r.code===1e3)return P>0;if(!N||W>=N||!x(r)||$!=null&&$(r))throw r;return F=!0}return T||(async()=>{for(P++;;)try{const[,,r]=await Q();await r}catch(r){try{if(!Z(r))return}catch(y){return s==null?void 0:s(y)}}})(),{on:h.on,subscribe(r,y){const a=k();let n=!1,u=!1,I=()=>{P--,n=!0};return(async()=>{for(P++;;)try{const[o,R,D]=await Q();if(n)return R();const z=h.onMessage(a,O=>{switch(O.type){case p.Next:{y.next(O.payload);return}case p.Error:{u=!0,n=!0,y.error(O.payload),I();return}case p.Complete:{n=!0,I();return}}});o.send(H({id:a,type:p.Subscribe,payload:r},A)),I=()=>{!n&&o.readyState===_.OPEN&&o.send(H({id:a,type:p.Complete},A)),P--,n=!0,R()},await D.finally(z);return}catch(o){if(!Z(o))return}})().then(()=>{u||y.complete()}).catch(o=>{y.error(o)}),()=>{n||I()}},async dispose(){if(J=!0,M){const[r]=await M;r.close(1e3,"Normal Closure")}},terminate(){M&&h.emit("closed",{code:4499,reason:"Terminated",wasClean:!1})}}}function j(e){return B(e)&&"code"in e&&"reason"in e}function oe(e){return[1e3,1001,1006,1005,1012,1013,1013].includes(e)?!1:e>=1e3&&e<=1999}function ie(e){return typeof e=="function"&&"constructor"in e&&"CLOSED"in e&&"CLOSING"in e&&"CONNECTING"in e&&"OPEN"in e}setInterval(()=>document.getElementById("datetime").innerHTML=new Date().toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}),1);const Y=ne({url:"wss://streaming.bitquery.io/graphql"}),se=10,K=async(e,d)=>{const m=document.createElement("div");m.classList.add("nft");const s=await(await fetch(e)).blob(),c=URL.createObjectURL(s);m.style.backgroundImage=`url(${c})`;const i=Math.floor(Math.random()*(100-25+1)+25)/100,l=se*i;m.style.height=`${l}vmax`,m.style.width=`${l}vmax`;const E=3/i<=3?3:3/i;m.style.animation=`falling ${E}s`;const N=Math.random()*window.innerWidth;m.style.left=`${N}px`;const f=document.getElementById("app"),x=document.createElement("span");x.style.fontSize=`${l/5}vmax`,x.innerHTML=d||"",m.appendChild(x),f.appendChild(m),setTimeout(()=>{f.removeChild(m)},E*1e3)};async function ae(e){return new Promise((d,m)=>{let T;Y.subscribe(e,{next:async s=>{s.data.EVM.Transfers.forEach(async({Transfer:{URI:i,name:l}})=>{if(i&&i.match(/data:image/gm))K(i,l);else if(!i.match(/^ipfs:\/\//gm))try{const N=await(await fetch(i)).json();N.image&&K(N.image,N.name)}catch{}})},error:m,complete:()=>d(T)})})}async function ce(e){return new Promise((d,m)=>{let T;Y.subscribe(e,{next:s=>{const c=s.data.EVM,i=document.getElementById("trades");c.buy.forEach((l,E,N)=>{const f=document.createElement("div"),x=document.createElement("div"),$=document.createElement("div"),t=document.createElement("div"),L=document.createElement("div");f.classList.add("trades__row"),x.classList.add("trades__column","time"),$.classList.add("trades__column","address"),t.classList.add("trades__column","action"),L.classList.add("trades__column","forprice"),x.innerHTML=`${new Date(l.Block.Time).toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}).split(", ")[1]}`,$.innerHTML=` ${l.Trade.Sell.Buyer.substring(0,10)}...`,t.innerHTML=` buy ${l.Trade.Buy.Amount.Decimal.substring(0,10)} ${l.Trade.Buy.Currency.Symbol}`,L.innerHTML=` for ${l.Trade.Sell.Amount.Decimal.substring(0,6)} ${l.Trade.Sell.Currency.Symbol}`,setTimeout(()=>{f.appendChild(x),f.appendChild($),f.appendChild(t),f.appendChild(L),i.appendChild(f);const k=document.getElementById("price"),A=l.Trade.Buy.Price,q=+A>+k.innerHTML?"green":"red";k.innerHTML=A.toFixed(5),k.classList.remove("green","red"),k.classList.add(q),i.children.length>20&&i.removeChild(i.children.item(0))},E*2500/c.buy.length)}),c.sell.forEach((l,E,N)=>{const f=document.createElement("div"),x=document.createElement("div"),$=document.createElement("div"),t=document.createElement("div"),L=document.createElement("div");f.classList.add("trades__row"),x.classList.add("trades__column","time"),$.classList.add("trades__column","address"),t.classList.add("trades__column","action"),L.classList.add("trades__column","forprice"),x.innerHTML=`${new Date(l.Block.Time).toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}).split(", ")[1]}`,$.innerHTML=` ${l.Trade.Sell.Buyer.substring(0,10)}...`,t.innerHTML=` sell ${l.Trade.Sell.Amount.Decimal.substring(0,10)} ${l.Trade.Sell.Currency.Symbol}`,L.innerHTML=` for ${l.Trade.Buy.Amount.Decimal.substring(0,6)} ${l.Trade.Buy.Currency.Symbol}`,setTimeout(()=>{f.appendChild(x),f.appendChild($),f.appendChild(t),f.appendChild(L),i.appendChild(f);const k=document.getElementById("price"),A=l.Trade.Sell.Price,q=+A>+k.innerHTML?"green":"red";k.innerHTML=A.toFixed(5),k.classList.remove("green","red"),k.classList.add(q),i.children.length>20&&i.removeChild(i.children.item(0))},E*2500/c.sell.length)})},error:m,complete:()=>d(T)})})}(async()=>{try{const e=await Promise.all[ce({query:`subscription {
				EVM(network: bsc){
				  buy: DEXTrades(Trade: {
					Sell: {Currency: {SmartContract: {is: "0x55d398326f99059ff775485246999027b3197955"}}}
					Buy: {Currency: {SmartContract: {is: "0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"}}}
				  }) {
					Block {
					  Time
					}
					Trade {
					  Sell {
						Buyer
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
								  }
					  }
					  Buy {
						Price
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
						}
					  }
					}
				  }
				  sell: DEXTrades(Trade: {
					Buy: {Currency: {SmartContract: {is: "0x55d398326f99059ff775485246999027b3197955"}}}
					Sell: {Currency: {SmartContract: {is: "0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"}}}
			  
				  }) {
					Block {
					  Time
					}
					Trade {
					  Sell {
						Price
						Buyer
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
								  }
					  }
					  Buy {
						
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
						}
					  }
					}
				  }
				}
			  }`}),ae({query:`subscription {
			 EVM(network: bsc){
			  	Transfers(Transfer: {Currency: {HasURI: true}}) {
			     Transfer {
			       Receiver
			       Currency {
			         Name
			       }
			       URI
			      }
			    }
			  }
			}`})]}catch(e){console.log(e)}})();

</script>
  <style type="text/css">
@charset "UTF-8";*,*:before,*:after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media (prefers-reduced-motion: reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}.red{color:red}.green{color:green}@keyframes falling{0%{top:-20%;opacity:1}to{top:120%;opacity:0}}#app{font-family:swiss921-bt-regular,sans-serif;background-color:#000;color:#ececec;font-size:1.5vmax;display:flex;width:100vw;height:100vh;position:relative}#app .nft{z-index:15;position:absolute;background-size:cover;animation-iteration-count:1;border-radius:50%;animation-timing-function:cubic-bezier(.33333,0,.66667,.33333)}#app .nft span{position:absolute;bottom:-1.5em;display:block;width:100%;text-align:center;text-overflow:ellipsis}#app .logo{position:absolute;z-index:20;top:50px;right:7vmax;height:50px}#app .container{display:flex;flex-direction:column;flex:1 1 33%;height:100%}#app .container__left{position:relative}#app .container__left .item{display:flex;padding-left:7vmax}#app .container__left .item.number{padding-top:50px;flex:0 1 20%}#app .container__left .item.plug{position:relative;flex-direction:column;flex:0 1 80%;justify-content:flex-end}#app .container__left .item.cover{position:absolute;height:80vh;width:100vw;top:0;background-image:linear-gradient(to top,rgba(0,0,0,0) 0%,rgba(0,0,0,.9) 50%,rgb(0,0,0) 100%);z-index:10}#app .container__left .item.trades{position:absolute;display:flex;flex-direction:column;justify-content:flex-end;bottom:0;height:80vh;width:100vw;font-size:26px;opacity:.8;padding-left:3vmax}#app .container__left .item.trades .trades__row{display:flex;width:100%;height:3vmax;font-size:1.9vmax}#app .container__left .item.trades .trades__column{display:flex;flex:1;justify-content:flex-start}#app .container__left .item.trades .trades__column.time{flex-basis:15%}#app .container__left .item.trades .trades__column.address{flex-basis:25%}#app .container__left .item.trades .trades__column.action{flex-basis:35%}#app .container__left .item.trades .trades__column.forprice{flex-basis:25%}#app .container__middle{z-index:20;justify-content:center;align-items:center}#app .container__middle .token-price-exchange{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;margin:auto}#app .container__middle .token-price-exchange .token{font-size:4vmax;background:rgba(0,0,0,.5)}#app .container__middle .token-price-exchange .price{font-size:10vmax;font-weight:700}#app .container__middle .token-price-exchange .exchange{font-weight:700;margin-top:-2vmax}#app .container__middle .datetime{font-size:3vmax}#app .container__right{position:relative;justify-content:flex-end;align-items:center}

</style>
</head>
<body>
	<div id="app">
		<image class="logo" src="https://bitquery.io/wp-content/uploads/2021/11/Bitquery-RGB-White-Title-1024x328.png">
		</image>
		<div class="container container__left">
			<div class="item number"></div>
			<div class="item plug"></div>
			<div class="item cover"></div>
			<div id="trades" class="item trades">
			</div>
		</div>
		<div class="container container__middle">
			<div id="datetime" class="datetime"></div>
			<div class="token-price-exchange">
				<div id="price" class="price">--/--</div>
				<div class="token">WBNB/USDT</div>
				<div class="exchange"></div>
			</div>
		</div>
		<div class="container container__right">
		</div>
		<div class="nft"></div>
	</div>
	
</body>

</html>