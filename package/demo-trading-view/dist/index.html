<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="icon" href="https://graphql.bitquery.io/ide/favicon.png" />
	<title>Bitquery Streaming API</title>
  <script type="module" crossorigin>
(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))h(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&h(s)}).observe(document,{childList:!0,subtree:!0});function m(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerpolicy&&(c.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?c.credentials="include":i.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(i){if(i.ep)return;i.ep=!0;const c=m(i);fetch(i.href,c)}})();function x(e){return e===null?"null":Array.isArray(e)?"array":typeof e}function B(e){return x(e)==="object"}function te(e){return Array.isArray(e)&&e.length>0&&e.every(l=>"message"in l)}function K(e,l){return e.length<124?e:l}const re="graphql-transport-ws";var S;(function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"})(S||(S={}));var p;(function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"})(p||(p={}));function V(e){if(!B(e))throw new Error(`Message is expected to be an object, but got ${x(e)}`);if(!e.type)throw new Error("Message is missing the 'type' property");if(typeof e.type!="string")throw new Error(`Message is expects the 'type' property to be a string, but got ${x(e.type)}`);switch(e.type){case p.ConnectionInit:case p.ConnectionAck:case p.Ping:case p.Pong:{if("payload"in e&&!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object or missing, but got "${e.payload}"`);break}case p.Subscribe:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${x(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${x(e.payload)}`);if(typeof e.payload.query!="string")throw new Error(`"${e.type}" message payload expects the 'query' property to be a string, but got ${x(e.payload.query)}`);if(e.payload.variables!=null&&!B(e.payload.variables))throw new Error(`"${e.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${x(e.payload.variables)}`);if(e.payload.operationName!=null&&x(e.payload.operationName)!=="string")throw new Error(`"${e.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${x(e.payload.operationName)}`);if(e.payload.extensions!=null&&!B(e.payload.extensions))throw new Error(`"${e.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${x(e.payload.extensions)}`);break}case p.Next:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${x(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!B(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${x(e.payload)}`);break}case p.Error:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${x(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!te(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(e.payload)}`);break}case p.Complete:{if(typeof e.id!="string")throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${x(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);break}default:throw new Error(`Invalid message 'type' property "${e.type}"`)}return e}function ne(e,l){try{return V(e)}catch{if(typeof e!="string")throw new Error("Only strings are parsable messages");const h=JSON.parse(e,l);return V(h)}}function H(e,l){return V(e),JSON.stringify(e,l)}function oe(e){const{url:l,connectionParams:m,lazy:h=!0,onNonLazyError:i=console.error,lazyCloseTimeout:c=0,keepAlive:s=0,disablePong:d,connectionAckWaitTimeout:L=0,retryAttempts:P=5,retryWait:w=async function(y){let a=1e3;for(let n=0;n<y;n++)a*=2;await new Promise(n=>setTimeout(n,a+Math.floor(Math.random()*(3e3-300)+300)))},shouldRetry:k=F,isFatalConnectionProblem:E,on:t,webSocketImpl:T,generateID:$=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,y=>{const a=Math.random()*16|0;return(y=="x"?a:a&3|8).toString(16)})},jsonMessageReplacer:N,jsonMessageReviver:O}=e;let C;if(T){if(!se(T))throw new Error("Invalid WebSocket implementation provided");C=T}else typeof WebSocket<"u"?C=WebSocket:typeof global<"u"?C=global.WebSocket||global.MozWebSocket:typeof window<"u"&&(C=window.WebSocket||window.MozWebSocket);if(!C)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const _=C,b=(()=>{const r=(()=>{const a={};return{on(n,u){return a[n]=u,()=>{delete a[n]}},emit(n){var u;"id"in n&&((u=a[n.id])===null||u===void 0||u.call(a,n))}}})(),y={connecting:t!=null&&t.connecting?[t.connecting]:[],opened:t!=null&&t.opened?[t.opened]:[],connected:t!=null&&t.connected?[t.connected]:[],ping:t!=null&&t.ping?[t.ping]:[],pong:t!=null&&t.pong?[t.pong]:[],message:t!=null&&t.message?[r.emit,t.message]:[r.emit],closed:t!=null&&t.closed?[t.closed]:[],error:t!=null&&t.error?[t.error]:[]};return{onMessage:r.on,on(a,n){const u=y[a];return u.push(n),()=>{u.splice(u.indexOf(n),1)}},emit(a,...n){for(const u of[...y[a]])u(...n)}}})();function J(r){const y=[b.on("error",a=>{y.forEach(n=>n()),r(a)}),b.on("closed",a=>{y.forEach(n=>n()),r(a)})]}let A,I=0,Q,j=!1,W=0,U=!1;async function Z(){clearTimeout(Q);const[r,y]=await(A!=null?A:A=new Promise((u,M)=>(async()=>{if(j){if(await w(W),!I)return A=void 0,M({code:1e3,reason:"All Subscriptions Gone"});W++}b.emit("connecting");const o=new _(typeof l=="function"?await l():l,re);let q,D;function z(){isFinite(s)&&s>0&&(clearTimeout(D),D=setTimeout(()=>{o.readyState===_.OPEN&&(o.send(H({type:p.Ping})),b.emit("ping",!1,void 0))},s))}J(f=>{A=void 0,clearTimeout(q),clearTimeout(D),M(f),F(f)&&f.code===4499&&(o.close(4499,"Terminated"),o.onerror=null,o.onclose=null)}),o.onerror=f=>b.emit("error",f),o.onclose=f=>b.emit("closed",f),o.onopen=async()=>{try{b.emit("opened",o);const f=typeof m=="function"?await m():m;if(o.readyState!==_.OPEN)return;o.send(H(f?{type:p.ConnectionInit,payload:f}:{type:p.ConnectionInit},N)),isFinite(L)&&L>0&&(q=setTimeout(()=>{o.close(S.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")},L)),z()}catch(f){b.emit("error",f),o.close(S.InternalClientError,K(f instanceof Error?f.message:new Error(f).message,"Internal client error"))}};let R=!1;o.onmessage=({data:f})=>{try{const g=ne(f,O);if(b.emit("message",g),g.type==="ping"||g.type==="pong"){b.emit(g.type,!0,g.payload),g.type==="pong"?z():d||(o.send(H(g.payload?{type:p.Pong,payload:g.payload}:{type:p.Pong})),b.emit("pong",!1,g.payload));return}if(R)return;if(g.type!==p.ConnectionAck)throw new Error(`First message cannot be of type ${g.type}`);clearTimeout(q),R=!0,b.emit("connected",o,g.payload),j=!1,W=0,u([o,new Promise((le,ee)=>J(ee))])}catch(g){o.onmessage=null,b.emit("error",g),o.close(S.BadResponse,K(g instanceof Error?g.message:new Error(g).message,"Bad response"))}}})()));r.readyState===_.CLOSING&&await y;let a=()=>{};const n=new Promise(u=>a=u);return[r,a,Promise.race([n.then(()=>{if(!I){const u=()=>r.close(1e3,"Normal Closure");isFinite(c)&&c>0?Q=setTimeout(()=>{r.readyState===_.OPEN&&u()},c):u()}}),y])]}function X(r){if(F(r)&&(ie(r.code)||[S.InternalServerError,S.InternalClientError,S.BadRequest,S.BadResponse,S.Unauthorized,S.SubprotocolNotAcceptable,S.SubscriberAlreadyExists,S.TooManyInitialisationRequests].includes(r.code)))throw r;if(U)return!1;if(F(r)&&r.code===1e3)return I>0;if(!P||W>=P||!k(r)||E!=null&&E(r))throw r;return j=!0}return h||(async()=>{for(I++;;)try{const[,,r]=await Z();await r}catch(r){try{if(!X(r))return}catch(y){return i==null?void 0:i(y)}}})(),{on:b.on,subscribe(r,y){const a=$();let n=!1,u=!1,M=()=>{I--,n=!0};return(async()=>{for(I++;;)try{const[o,q,D]=await Z();if(n)return q();const z=b.onMessage(a,R=>{switch(R.type){case p.Next:{y.next(R.payload);return}case p.Error:{u=!0,n=!0,y.error(R.payload),M();return}case p.Complete:{n=!0,M();return}}});o.send(H({id:a,type:p.Subscribe,payload:r},N)),M=()=>{!n&&o.readyState===_.OPEN&&o.send(H({id:a,type:p.Complete},N)),I--,n=!0,q()},await D.finally(z);return}catch(o){if(!X(o))return}})().then(()=>{u||y.complete()}).catch(o=>{y.error(o)}),()=>{n||M()}},async dispose(){if(U=!0,A){const[r]=await A;r.close(1e3,"Normal Closure")}},terminate(){A&&b.emit("closed",{code:4499,reason:"Terminated",wasClean:!1})}}}function F(e){return B(e)&&"code"in e&&"reason"in e}function ie(e){return[1e3,1001,1006,1005,1012,1013,1013].includes(e)?!1:e>=1e3&&e<=1999}function se(e){return typeof e=="function"&&"constructor"in e&&"CLOSED"in e&&"CLOSING"in e&&"CONNECTING"in e&&"OPEN"in e}setInterval(()=>document.getElementById("datetime").innerHTML=new Date().toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}),1);const v=oe({url:"wss://streaming.bitquery.io/graphql"}),G=20,Y=(e,l)=>{const m=document.createElement("div");m.classList.add("nft"),m.style.backgroundImage=`url(${e})`;const h=Math.random()*G/2+G/2;m.style.height=`${h}vmax`,m.style.width=`${h}vmax`;const i=G/h*7<=1?1:14/h*7;m.style.animation=`falling ${i}s`;const c=Math.random()*window.innerWidth;m.style.left=`${c}px`;const s=document.getElementById("app"),d=document.createElement("span");d.innerHTML=l||"",m.appendChild(d),s.appendChild(m),setTimeout(()=>{s.removeChild(m)},5e3)};async function ae(e){return new Promise((l,m)=>{let h;v.subscribe(e,{next:async i=>{i.data.EVM.Transfers.forEach(async({Transfer:{URI:s,name:d}})=>{if(s&&s.match(/data:image/gm))Y(s,d);else if(!s.match(/^ipfs:\/\//gm))try{const P=await(await fetch(s)).json();P.image&&Y(P.image,P.name)}catch{}})},error:m,complete:()=>l(h)})})}async function ce(e){return new Promise((l,m)=>{let h;v.subscribe(e,{next:i=>{const c=i.data.EVM,s=document.getElementById("trades");c.buy.forEach((d,L,P)=>{const w=document.createElement("div"),k=document.createElement("div"),E=document.createElement("div"),t=document.createElement("div"),T=document.createElement("div");w.classList.add("trades__row"),k.classList.add("trades__column","time"),E.classList.add("trades__column","address"),t.classList.add("trades__column","action"),T.classList.add("trades__column","forprice"),k.innerHTML=`${new Date(d.Block.Time).toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}).split(", ")[1]}`,E.innerHTML=` ${d.Trade.Sell.Buyer.substring(0,10)}...`,t.innerHTML=` buy ${d.Trade.Buy.Amount.Decimal.substring(0,10)} ${d.Trade.Buy.Currency.Symbol}`,T.innerHTML=` for ${d.Trade.Sell.Amount.Decimal.substring(0,6)} ${d.Trade.Sell.Currency.Symbol}`,setTimeout(()=>{w.appendChild(k),w.appendChild(E),w.appendChild(t),w.appendChild(T),s.appendChild(w);const $=document.getElementById("price"),N=d.Trade.Buy.Price,O=+N>+$.innerHTML?"green":"red";$.innerHTML=N.toFixed(5),$.classList.remove("green","red"),$.classList.add(O),s.children.length>20&&s.removeChild(s.children.item(0))},L*2500/c.buy.length)}),c.sell.forEach((d,L,P)=>{const w=document.createElement("div"),k=document.createElement("div"),E=document.createElement("div"),t=document.createElement("div"),T=document.createElement("div");w.classList.add("trades__row"),k.classList.add("trades__column","time"),E.classList.add("trades__column","address"),t.classList.add("trades__column","action"),T.classList.add("trades__column","forprice"),k.innerHTML=`${new Date(d.Block.Time).toLocaleString("en-SG",{timeZone:"Asia/Singapore",hour12:!1}).split(", ")[1]}`,E.innerHTML=` ${d.Trade.Sell.Buyer.substring(0,10)}...`,t.innerHTML=` sell ${d.Trade.Sell.Amount.Decimal.substring(0,10)} ${d.Trade.Sell.Currency.Symbol}`,T.innerHTML=` for ${d.Trade.Buy.Amount.Decimal.substring(0,6)} ${d.Trade.Buy.Currency.Symbol}`,setTimeout(()=>{w.appendChild(k),w.appendChild(E),w.appendChild(t),w.appendChild(T),s.appendChild(w);const $=document.getElementById("price"),N=d.Trade.Sell.Price,O=+N>+$.innerHTML?"green":"red";$.innerHTML=N.toFixed(5),$.classList.remove("green","red"),$.classList.add(O),s.children.length>20&&s.removeChild(s.children.item(0))},L*2500/c.sell.length)})},error:m,complete:()=>l(h)})})}(async()=>{try{const e=await Promise.all[ce({query:`subscription {
				EVM(network: bsc){
				  buy: DEXTrades(Trade: {
					Sell: {Currency: {SmartContract: {is: "0x55d398326f99059ff775485246999027b3197955"}}}
					Buy: {Currency: {SmartContract: {is: "0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"}}}
				  }) {
					Block {
					  Time
					}
					Trade {
					  Sell {
						Buyer
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
								  }
					  }
					  Buy {
						Price
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
						}
					  }
					}
				  }
				  sell: DEXTrades(Trade: {
					Buy: {Currency: {SmartContract: {is: "0x55d398326f99059ff775485246999027b3197955"}}}
					Sell: {Currency: {SmartContract: {is: "0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"}}}
			  
				  }) {
					Block {
					  Time
					}
					Trade {
					  Sell {
						Price
						Buyer
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
								  }
					  }
					  Buy {
						
						Amount {
									  Decimal
						}
						Currency {
						  Symbol
						}
					  }
					}
				  }
				}
			  }`}),ae({query:`subscription {
			 EVM(network: bsc){
			  	Transfers(Transfer: {Currency: {HasURI: true}}) {
			     Transfer {
			       Receiver
			       Currency {
			         Name
			       }
			       URI
			      }
			    }
			  }
			}`})]}catch(e){console.log(e)}})();

</script>
  <style type="text/css">
@charset "UTF-8";*,*:before,*:after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media (prefers-reduced-motion: reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}.red{color:red}.green{color:green}@keyframes falling{0%{top:-20%;opacity:1}to{top:120%;opacity:0}}#app{font-family:swiss921-bt-regular,sans-serif;background-color:#000;color:#ececec;font-size:1.5vmax;display:flex;width:100vw;height:100vh;position:relative}#app .nft{z-index:15;position:absolute;background-size:cover;animation-iteration-count:1;border-radius:50%;animation-timing-function:cubic-bezier(.33333,0,.66667,.33333)}#app .nft span{position:absolute;bottom:-1.5em;display:block;width:100%;text-align:center;text-overflow:ellipsis}#app .logo{position:absolute;z-index:20;top:50px;right:7vmax;height:50px}#app .container{display:flex;flex-direction:column;flex:1 1 33%;height:100%}#app .container__left{position:relative}#app .container__left .item{display:flex;padding-left:7vmax}#app .container__left .item.number{padding-top:50px;flex:0 1 20%}#app .container__left .item.plug{position:relative;flex-direction:column;flex:0 1 80%;justify-content:flex-end}#app .container__left .item.cover{position:absolute;height:80vh;width:100vw;top:0;background-image:linear-gradient(to top,rgba(0,0,0,0) 0%,rgba(0,0,0,.9) 50%,rgb(0,0,0) 100%);z-index:10}#app .container__left .item.trades{position:absolute;display:flex;flex-direction:column;justify-content:flex-end;bottom:0;height:80vh;width:100vw;font-size:26px;opacity:.8;padding-left:3vmax}#app .container__left .item.trades .trades__row{display:flex;width:100%;height:3vmax;font-size:1.9vmax}#app .container__left .item.trades .trades__column{display:flex;flex:1;justify-content:flex-start}#app .container__left .item.trades .trades__column.time{flex-basis:15%}#app .container__left .item.trades .trades__column.address{flex-basis:25%}#app .container__left .item.trades .trades__column.action{flex-basis:35%}#app .container__left .item.trades .trades__column.forprice{flex-basis:25%}#app .container__middle{z-index:20;justify-content:center;align-items:center}#app .container__middle .token-price-exchange{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;margin:auto}#app .container__middle .token-price-exchange .token{font-size:4vmax;background:rgba(0,0,0,.5)}#app .container__middle .token-price-exchange .price{font-size:10vmax;font-weight:700}#app .container__middle .token-price-exchange .exchange{font-weight:700;margin-top:-2vmax}#app .container__middle .datetime{font-size:3vmax}#app .container__right{position:relative;justify-content:flex-end;align-items:center}

</style>
</head>
<body>
	<div id="app">
		<image class="logo" src="https://bitquery.io/wp-content/uploads/2021/11/Bitquery-RGB-White-Title-1024x328.png">
		</image>
		<div class="container container__left">
			<div class="item number"></div>
			<div class="item plug"></div>
			<div class="item cover"></div>
			<div id="trades" class="item trades">
			</div>
		</div>
		<div class="container container__middle">
			<div id="datetime" class="datetime"></div>
			<div class="token-price-exchange">
				<div id="price" class="price">--/--</div>
				<div class="token">WBNB/USDT</div>
				<div class="exchange"></div>
			</div>
		</div>
		<div class="container container__right">
		</div>
		<div class="nft"></div>
	</div>
	
</body>

</html>